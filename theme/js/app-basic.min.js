/*!
  geo-location-javascript v0.4.3
  http://code.google.com/p/geo-location-javascript/
 
  Copyright (c) 2009 Stan Wiechers
  Licensed under the MIT licenses.
 
  Revision: $Rev: 68 $: 
  Author: $Author: whoisstan $:
  Date: $Date: 2010-02-15 13:42:19 +0100 (Mon, 15 Feb 2010) $:    
 */
var bb_successCallback,bb_errorCallback,bb_blackberryTimeout_id=-1;function handleBlackBerryLocationTimeout(){bb_blackberryTimeout_id!=-1&&bb_errorCallback({message:"Timeout error",code:3})}
function handleBlackBerryLocation(){clearTimeout(bb_blackberryTimeout_id);bb_blackberryTimeout_id=-1;if(bb_successCallback&&bb_errorCallback){if(blackberry.location.latitude==0&&blackberry.location.longitude==0)bb_errorCallback({message:"Position unavailable",code:2});else{var e=null;if(blackberry.location.timestamp)e=new Date(blackberry.location.timestamp);bb_successCallback({timestamp:e,coords:{latitude:blackberry.location.latitude,longitude:blackberry.location.longitude}})}bb_errorCallback=bb_successCallback=null}}
var geo_position_js=function(){var e={},c=null;e.getCurrentPosition=function(g,f,d){c.getCurrentPosition(g,f,d)};e.init=function(){try{if(typeof geo_position_js_simulator!="undefined")c=geo_position_js_simulator;else if(typeof bondi!="undefined"&&typeof bondi.geolocation!="undefined")c=bondi.geolocation;else if(typeof navigator.geolocation!="undefined"){c=navigator.geolocation;e.getCurrentPosition=function(f,d,a){c.getCurrentPosition(function(b){typeof b.latitude!="undefined"?f({timestamp:b.timestamp,coords:{latitude:b.latitude,
longitude:b.longitude}}):f(b)},d,a)}}else if(typeof window.google!="undefined"&&typeof google.gears!="undefined")c=google.gears.factory.create("beta.geolocation");else if(typeof Mojo!="undefined"&&typeof Mojo.Service.Request!="Mojo.Service.Request"){c=true;e.getCurrentPosition=function(f,d,a){parameters={};if(a){if(a.enableHighAccuracy&&a.enableHighAccuracy==true)parameters.accuracy=1;if(a.maximumAge)parameters.maximumAge=a.maximumAge;if(a.responseTime)if(a.responseTime<5)parameters.responseTime=1;
else if(a.responseTime<20)parameters.responseTime=2;else parameters.timeout=3}r=new Mojo.Service.Request("palm://com.palm.location",{method:"getCurrentPosition",parameters:parameters,onSuccess:function(b){f({timestamp:b.timestamp,coords:{latitude:b.latitude,longitude:b.longitude,heading:b.heading}})},onFailure:function(b){if(b.errorCode==1)d({code:3,message:"Timeout"});else b.errorCode==2?d({code:2,message:"Position Unavailable"}):d({code:0,message:"Unknown Error: webOS-code"+errorCode})}})}}else if(typeof device!=
"undefined"&&typeof device.getServiceObject!="undefined"){c=device.getServiceObject("Service.Location","ILocation");e.getCurrentPosition=function(f,d){var a={};a.LocationInformationClass="BasicLocationInformation";c.ILocation.GetLocation(a,function(b,i,h){i==4?d({message:"Position unavailable",code:2}):f({timestamp:null,coords:{latitude:h.ReturnValue.Latitude,longitude:h.ReturnValue.Longitude,altitude:h.ReturnValue.Altitude,heading:h.ReturnValue.Heading}})})}}else if(typeof window.blackberry!="undefined"&&
blackberry.location.GPSSupported){if(typeof blackberry.location.setAidMode=="undefined")return false;blackberry.location.setAidMode(2);e.getCurrentPosition=function(f,d,a){bb_successCallback=f;bb_errorCallback=d;bb_blackberryTimeout_id=a.timeout?setTimeout("handleBlackBerryLocationTimeout()",a.timeout):setTimeout("handleBlackBerryLocationTimeout()",6E4);blackberry.location.onLocationUpdate("handleBlackBerryLocation()");blackberry.location.refreshLocation()};c=blackberry.location}}catch(g){alert("error="+
g);typeof console!="undefined"&&console.log(g);return false}return c!=null};return e}();

/*
 Ottawa Dog Park Finder
 @author: Thomas J Bradley <theman@thomasjbradley.ca>
 @link: http://thomasjbradley.ca
 @copyright: Copyright MMXI, Thomas J Bradley (http://thomasjbradley.ca)
*/
function $id(a){return document.getElementById(a)}function bind(a,b,c){if(b.addEventListener)b.addEventListener(a,c,false);else b.attachEvent&&b.attachEvent("on"+a,c)}function unbind(a,b,c){if(b.removeEventListener)b.removeEventListener(a,c,false);else b.detachEvent&&b.detachEvent("on"+a,c)}function addClass(a,b){a.className+=" "+b}function removeClass(a,b){a.className=a.className.replace(RegExp("s*"+b,"g"),"")}Modernizr.addTest("xhr",function(){return typeof XMLHttpRequest!="undefined"});
Modernizr.addTest("mediaqueries",function(){var a=false,b=document.createElement("div"),c=document.createElement("style"),d=document.createTextNode("#modernizr-mq-tester{top:-999em;position:absolute;display:none;} @media screen and (min-width:5px){#modernizr-mq-tester{display:block;}}"),e=document.getElementsByTagName("head")[0];b.id="modernizr-mq-tester";b.innerHTML="&nbsp;";c.id="modernizr-mq-styles";try{c.appendChild(d);e.appendChild(c);document.documentElement.appendChild(b);a=getComputedStyle(b,
null).getPropertyValue("display")=="block";e.removeChild(c);document.documentElement.removeChild(b)}catch(f){}return a});
Modernizr.addTest("googlemaps",function(){var a=document.documentElement.clientWidth,b=document.documentElement.className.indexOf("ie7")>-1,c=document.documentElement.className.indexOf("ie8")>-1,d=document.documentElement.className.indexOf("ie7mobile")>-1;if(a<600||!Modernizr.xhr||d)return false;if(a<780&&Modernizr.touch&&Modernizr.mediaqueries||a>=780&&(Modernizr.mediaqueries||c||b))return true;return false});
var SimpleTabs={init:function(){if($id("nearby-tab")){bind("click",$id("nearby-tab").childNodes[0],function(a){SimpleTabs.hide();SimpleTabs.show("nearby");a.preventDefault&&a.preventDefault();a.returnValue=false});bind("click",$id("popular-tab").childNodes[0],function(a){SimpleTabs.hide();SimpleTabs.show("popular");a.preventDefault&&a.preventDefault();a.returnValue=false});bind("click",$id("friendly-tab").childNodes[0],function(a){SimpleTabs.hide();SimpleTabs.show("friendly");a.preventDefault&&a.preventDefault();
a.returnValue=false});bind("click",$id("clean-tab").childNodes[0],function(a){SimpleTabs.hide();SimpleTabs.show("clean");a.preventDefault&&a.preventDefault();a.returnValue=false})}},hide:function(){removeClass($id("nearby"),"tabpanel-expanded");removeClass($id("popular"),"tabpanel-expanded");removeClass($id("friendly"),"tabpanel-expanded");removeClass($id("clean"),"tabpanel-expanded");removeClass($id("nearby-tab"),"tab-active");removeClass($id("popular-tab"),"tab-active");removeClass($id("friendly-tab"),
"tab-active");removeClass($id("clean-tab"),"tab-active")},show:function(a){addClass($id(a),"tabpanel-expanded");addClass($id(a+"-tab"),"tab-active")}},SimpleGeo={init:function(){geo_position_js.init()&&SimpleGeo.getGeo()},getGeo:function(){geo_position_js.getCurrentPosition(SimpleGeo.getGeoSuccess,SimpleGeo.getGeoError)},getGeoSuccess:function(a){removeClass($id("currentloc"),"no-geo");addClass($id("locform"),"geo");$id("currentloc").href+="?lat="+a.coords.latitude+"&lng="+a.coords.longitude;if(!$id("static-map-img")){removeClass($id("map-wrapper"),
"no-map");var b=document.createElement("script");b.async=true;b.src="/nearby?r=jsonp&lat="+a.coords.latitude+"&lng="+a.coords.longitude;document.getElementsByTagName("body")[0].appendChild(b)}},getGeoError:function(){},response:function(a){if($id("map")&&$id("nearby")){$id("map").innerHTML=a.image;$id("nearby").innerHTML=a.nearby;SimpleTabs.hide();removeClass($id("tablist-wrapper"),"no-nearby");SimpleTabs.show("nearby")}}},Enhancer={isEnhanced:false,enhance:function(){if(Modernizr.googlemaps){Enhancer.isEnhanced=
true;var a=document.createElement("link");a.rel="stylesheet";a.href=env=="dev"?"/theme/css/enhanced.css":"/theme/css/enhanced.min.css";a.media="screen,projection,tv";document.getElementsByTagName("head")[0].appendChild(a);a=document.createElement("link");a.rel="stylesheet";a.href=env=="dev"?"/theme/css/enhanced-wide.css":"/theme/css/enhanced-wide.min.css";a.media=Modernizr.mediaqueries?"screen and (min-width:1000px)":"screen,projection,tv";document.getElementsByTagName("head")[0].appendChild(a);removeClass($id("map-wrapper"),
"no-map");removeClass($id("map-wrapper"),"map-static");removeClass($id("tablist-wrapper"),"no-clean");removeClass($id("parks"),"no-rating");addClass($id("nearby-loader"),"no-nearby-loader");Enhancer.loadScriptAsync("http://maps.google.com/maps/api/js?sensor=false&region=CA&callback=gmapSuccess")}},loadScript:function(a){document.write('<script src="'+a+'"><\/script>')},loadScriptAsync:function(a){var b=document.createElement("script");b.src=a;b.async=true;document.getElementsByTagName("head")[0].appendChild(b)}};
function gmapSuccess(){Enhancer.loadScriptAsync("/app-enhanced.min.js")}Enhancer.enhance();bind("load",window,function(){SimpleTabs.init();Enhancer.isEnhanced||setTimeout(function(){SimpleGeo.init()},250)});
